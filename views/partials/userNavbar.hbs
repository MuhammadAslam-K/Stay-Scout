{{!-- {{>userHeader}} --}}

<style>
    .search_container {
        position: relative;
        display: flex;
        align-items: center;
        margin-left: 10px;
    }

    .search_icon {
        color: #ffffff;
        font-size: 18px;
        margin-right: 5px;
        cursor: pointer;
    }

    .search_input {
        width: 200px;
        padding: 5px;
        border: 1px solid #ccc;
        border-radius: 5px;
        transition: width 0.3s ease;
    }

    .search_input:focus {
        width: 250px;
    }
</style>

<header class="header">
    <div class="header_content d-flex flex-row align-items-center justify-content-start">
        <div class="logo"><a href="/">Stay Scout</a></div>

        <div class="ml-auto d-flex flex-row align-items-center justify-content-start">
            <nav class="main_nav">
                <ul class="d-flex flex-row align-items-start justify-content-start">
                    <li><a href="/">Home</a></li>
                    <li><a href="/hotels">Hotels</a></li>
                    <li><a href="/rooms">Rooms</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/findNearestHotel" id="nearestBtn">Nearest Hotel</a></li>
                    <li><button onclick="getProfile()"><i class="fa-solid fa-user"></i></button></li>
                    <li>
                        <form action="/hotel/search" method="post">
                            <div class="search_container">
                                <div class="search_icon"><i class="fa-solid fa-search"></i></div>
                                <input type="text" class="search_input" placeholder="Search" name="search">
                            </div>
                        </form>
                    </li>
                </ul>
            </nav>
            {{!-- href="/contact" --}}
            <!-- Hamburger Menu -->
            <div class="hamburger"><i class="fa fa-bars" aria-hidden="true"></i></div>
        </div>
    </div>
</header>

<!-- Menu -->

<div class="menu trans_400 d-flex flex-column align-items-end justify-content-start">
    <div class="menu_close"><i class="fa fa-times" aria-hidden="true"></i></div>
    <div class="menu_content">
        <nav class="menu_nav text-right">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/hotels">Hotels</a></li>
                <li><a href="/rooms">Rooms</a></li>
                <li><a href="/contact">Contact</a></li>
                <li><a href="#" id="neare">Nearest Hotel</a></li>
                <li><a href="/profile"><i class="fa-solid fa-user"></i></a></li>
            </ul>
        </nav>
    </div>
</div>
{{!-- {{>userFooter}} --}}


<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
{{!-- To Find the Nearest Hotel --}}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const nearestBtn = document.getElementById("nearestBtn");

        nearestBtn.addEventListener("click", function (event) {
            event.preventDefault();

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function (position) {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;

                        const url = `/findNearestHotel/${latitude}/${longitude}`;
                        window.location.href = url;
                    },
                    function (error) {
                        console.error("Error getting user's location:", error);
                    }
                );
            } else {
                console.error("Geolocation is not supported by this browser.");
            }
        });
    });

</script>

{{!-- GET PROFILE --}}
<script>
    async function getProfile() {
        const token = localStorage.getItem('jwt_token');
        const config = {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        };
        console.log(config)
        try {
            // Use Axios to fetch the profile page HTML from the server
            const response = await axios.get('/profile', config);

            // If the response is successful, replace the content of the main container with the profile page
            if (response.status === 200) {
                const mainContainer = document.getElementById('main_container');
                mainContainer.innerHTML = response.data;
            } else {
                // If the response is not successful, handle the error
                // For example, redirect to login or show an error message
                console.log("Error: ", response.status);
            }
        } catch (error) {
            console.log(error);
        }
    }


</script>